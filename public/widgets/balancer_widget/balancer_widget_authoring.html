<div ng-controller="GameAuthoringCtrl as authoring" class="container game authoring balancer">
  <game-editor content-controller="GameContentCtrl as content">
    <div ng-include="'/components/authoring/game/editor-header.html'"></div>

    <div class="example" ng-class="{
      left: content.authoring_answer_display.weight == 1 || !content.authoring_answer_display,
      right: content.authoring_answer_display.weight == 3
    }" style="color: black;">
      <h3>Output</h3>
      {{authoring_answer_display}}
      <div class="to-compare"
           style="background-image: url('data:image/png;base64, {{content.round.comparison.img}}');
                  font-size: {{content.round.font_size}}px;
                  font-family: Verdana;
                  width: 120px; height: 50px;">
        {{content.round.comparison.content}}
      </div>
      <div class="answer"
           style="background-image: url('data:image/png;base64, {{content.authoring_answer_display.img}}');
                  font-size: {{content.round.font_size}}px;
                  font-family: Verdana;
                  width: 120px; height: 50px;">
        {{content.authoring_answer_display.content}}
      </div>
      <div class="bar">&nbsp;</div>
      <div class="balance">&nbsp;</div>
    </div>


    <div class="sections">
        <div class="section">
            <div ng-include="'/components/authoring/game/common-start.html'"></div>
        </div>

      <!-- Instructions -->
      <div class="section">

        <div class="form-group">
          <h3 class="col-sm-2">Instructions</h3>
        </div>

        <div class="form-group">
          <div class="col-sm-12">
            <textarea class="form-control" placeholder="Instructions" ng-model="content.round.instructions.content" rows="5"></textarea>
          </div>
        </div>
        <div class="form-group">
          <div class="col-sm-6">
            <label>
              <select class="form-control select-inline"
                      ng-model="content.round.instructions.align"
                      ng-init="content.round.instructions.align = content.round.instructions.align ? content.round.instructions.align : 'center'">
                <option value="center">Center Align</option>
                <option value="left">Left Align</option>
              </select>
            </label>
          </div>
        </div>

        <br/>
        <div class="form-group">
          <div class="col-sm-12">
            <textarea class="form-control" placeholder="Prompt" ng-model="content.round.prompt.content"
                      rows="{{content.round.prompt.img ? 1 : 5}}"
                      ng-readonly="content.round.prompt.img"></textarea>
          </div>
        </div>
        <div class="form-group">
          <div class="col-sm-12">
            <p>
              <input type="file"
                     data-is-prompt="true"
                     accept="image/*"
                     onchange="angular.element(this).scope().fileChanged(this)"/>
            </p>
            <p class="help-block">
              Upload an image to use as your prompt.
            </p>
            <p>
              <button class="btn btn-danger" ng-if="content.round.prompt.img" ng-click="content.deleteImg(content.round.prompt)">
                Remove
              </button>
            </p>
          </div>
          <div class="col-sm-12" ng-if="content.round.prompt.img">
            <img ng-src="data:image/png;base64, {{content.round.prompt.img}}" alt="Instructions Image" class="prompt-img"/>
          </div>
        </div>
        <div class="form-group">
          <div class="col-sm-6">
            <label>
              <select class="form-control select-inline"
                      ng-model="content.round.prompt.align"
                      ng-init="content.round.prompt.align = content.round.prompt.align ? content.round.prompt.align : 'center'">
                <option value="center">Center Align</option>
                <option value="left">Left Align</option>
              </select>
            </label>
          </div>
        </div>
      </div>

      <!-- Values -->
      <div class="section">
        <div class="form-group">
          <h3 class="col-sm-2">Values</h3>

          <div class="col-sm-10 edit-btns">
            <button class="btn btn-primary" ng-click="content.add('values')"
                    ng-show="content.sections.values.editing">Add
            </button>
            <button class="btn btn-primary" ng-click="content.toggleEdit('values')">
              {{content.sections.values.editing ? 'Done' : 'Edit'}}
            </button>
          </div>
        </div>

        <div ng-include="'/components/authoring/game/editor-fontsize.html'"></div>

        <div class="form-group">
          <div class="col-sm-12">
            <strong>Comparison</strong>
          </div>
        </div>
        <div ng-repeat="value in [content.round.comparison]">
          <div class="form-group can-delete">
            <div class="col-sm-4">
              <input type="text" class="form-control"
                     ng-readonly="!content.sections.values.editing"
                     placeholder="Value" ng-model="value.content"/>
            </div>
            <div class="col-sm-2" ng-include="'/components/authoring/game/editor-sizepicker.html'"></div>
            <div class="col-sm-3">
              <input type="file"
                     ng-if="!value.img"
                     accept="image/*"
                     data-is-comparison="true"
                     data-value-id="{{value.id}}"
                     onchange="angular.element(this).scope().fileChanged(this)"/>
              <img ng-if="value.img" ng-src="data:image/png;base64, {{value.img}}" alt="Comparison Image" style="width: 50px; height: 50px;"/>
              <button class="btn btn-danger with-text" ng-if="value.img" ng-click="content.deleteImg(value)">
                Remove
              </button>
            </div>
          </div>
        </div>

        <div class="form-group">
          <div class="col-sm-12">
            <strong>Values</strong>
          </div>
        </div>
        <div class="form-group can-delete" ng-repeat="value in content.values">
          <div class="row">
            <div class="col-sm-12">
              <input type="text" class="form-control"
                     ng-readonly="!content.sections.values.editing"
                     placeholder="Value" ng-model="value.content"/>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-2">
              <select class="form-control" ng-model="value.weight">
                <option ng-repeat="weight in content.weights" value="{{weight.id}}" ng-selected="value.weight == weight.id">{{weight.name}}</option>
              </select>
            </div>
            <div class="col-sm-2" ng-include="'/components/authoring/game/editor-sizepicker.html'"></div>
            <div class="col-sm-4">
              <input type="file"
                     ng-if="!value.img"
                     accept="image/*"
                     data-value-id="{{value.id}}"
                     onchange="angular.element(this).scope().fileChanged(this)"/>
              <img ng-if="value.img" ng-src="data:image/png;base64, {{value.img}}" alt="Value Image" style="width: 50px; height: 50px;"/>
              <button class="btn btn-danger with-text" ng-if="value.img" ng-click="content.deleteImg(value)">
                Remove
              </button>
            </div>
            <div class="col-sm-2">
              <label>
                <input type="radio" name="answer" ng-model="content.round.answer" ng-value="value.id" ng-click="content.updateAnswer(value.id)"/>
                &nbsp; Answer
              </label>
            </div>
            <div class="col-sm-1">
              <button class="btn btn-danger"
                      ng-click="content.remove('values', value)"
                      ng-if="content.sections.values.editing">-
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Feedback -->
      <div class="section">
        <div ng-include="'/components/authoring/game/editor-general-feedback.html'"></div>

        <!-- Specific feedback -->
        <div class="form-group">
          <div class="col-sm-12">
            Specific Incorrect Feedback
          </div>
        </div>
        <div class="form-group can-delete" ng-repeat="feedback in content.feedback">
          <div class="col-sm-3">
            <select class="form-control" ng-model="feedback.answer">
              <option ng-repeat="value in content.values" value="{{value.id}}" ng-selected="feedback.answer == value.id">{{value.content}}</option>
            </select>
          </div>

          <div class="col-sm-8">
            <textarea class="form-control"
                      rows="6"
                      ng-model="feedback.content" ng-readonly="!content.sections.feedback.editing">
              {{feedback.content}}
            </textarea>
          </div>
          <div class="col-sm-1">
            <button class="btn btn-danger"
                    ng-click="content.remove('feedback', feedback)"
                    ng-if="content.sections.feedback.editing">-
            </button>
          </div>
        </div>
      </div>
    </div>
  </game-editor>
</div>
